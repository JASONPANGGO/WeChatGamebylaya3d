var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**This class is automatically generated by LayaAirIDE, please do not make any modifications. */


var _GameUI = require("./script/GameUI");

var _GameUI2 = _interopRequireDefault(_GameUI);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameConfig = function () {
    function GameConfig() {
        _classCallCheck(this, GameConfig);
    }

    _createClass(GameConfig, null, [{
        key: "init",
        value: function init() {
            //注册Script或者Runtime引用
            var reg = Laya.ClassUtils.regClass;
            reg("script/GameUI.js", _GameUI2.default);
        }
    }]);

    return GameConfig;
}();

// GameConfig.width = 640;
// GameConfig.height = 1136;


exports.default = GameConfig;
GameConfig.scaleMode = Laya.Stage.SCALE_FULL;
GameConfig.screenMode = "none";
GameConfig.startScene = "test/TestScene.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = true;
GameConfig.physicsDebug = true;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{"./script/GameUI":4}],2:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameConfig = require("./GameConfig");

var _GameConfig2 = _interopRequireDefault(_GameConfig);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
	function Main() {
		_classCallCheck(this, Main);

		//根据IDE设置初始化引擎		
		if (window["Laya3D"]) Laya3D.init(_GameConfig2.default.width, _GameConfig2.default.height);else Laya.init(_GameConfig2.default.width, _GameConfig2.default.height, Laya["WebGL"]);
		Laya["Physics"] && Laya["Physics"].enable();
		Laya["DebugPanel"] && Laya["DebugPanel"].enable();
		Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
		Laya.stage.screenMode = _GameConfig2.default.screenMode;
		Laya.stage.alignV = _GameConfig2.default.alignV;
		Laya.stage.alignH = _GameConfig2.default.alignH;
		//兼容微信不支持加载scene后缀场景
		Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

		//打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
		if (_GameConfig2.default.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
		if (_GameConfig2.default.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
		if (_GameConfig2.default.stat) Laya.Stat.show();
		Laya.alertGlobalError = true;

		//激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
		Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
	}

	_createClass(Main, [{
		key: "onVersionLoaded",
		value: function onVersionLoaded() {
			//激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
			Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
		}
	}, {
		key: "onConfigLoaded",
		value: function onConfigLoaded() {
			//加载IDE指定的场景
			_GameConfig2.default.startScene && Laya.Scene.open(_GameConfig2.default.startScene);
		}
	}]);

	return Main;
}();
//激活启动类


new Main();

},{"./GameConfig":1}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var CameraMoveScript = function (_Laya$Script3D) {
    _inherits(CameraMoveScript, _Laya$Script3D);

    function CameraMoveScript() {
        _classCallCheck(this, CameraMoveScript);

        var _this = _possibleConstructorReturn(this, (CameraMoveScript.__proto__ || Object.getPrototypeOf(CameraMoveScript)).call(this));

        _this._tempVector3 = new Laya.Vector3();
        _this.yawPitchRoll = new Laya.Vector3();
        _this.resultRotation = new Laya.Quaternion();
        _this.tempRotationZ = new Laya.Quaternion();
        _this.tempRotationX = new Laya.Quaternion();
        _this.tempRotationY = new Laya.Quaternion();
        _this.rotaionSpeed = 0.00006;
        return _this;
    }

    _createClass(CameraMoveScript, [{
        key: "onAwake",
        value: function onAwake() {
            Laya.stage.on(Laya.Event.RIGHT_MOUSE_DOWN, this, this.mouseDown);
            Laya.stage.on(Laya.Event.RIGHT_MOUSE_UP, this, this.mouseUp);
            this.camera = this.owner;
        }
    }, {
        key: "_onDestroy",
        value: function _onDestroy() {
            //关闭监听函数
            Laya.stage.off(Laya.Event.RIGHT_MOUSE_DOWN, this, this.mouseDown);
            Laya.stage.off(Laya.Event.RIGHT_MOUSE_UP, this, this.mouseUp);
        }
    }, {
        key: "onUpdate",
        value: function onUpdate(state) {
            var elapsedTime = Laya.timer.delta;
            if (!isNaN(this.lastMouseX) && !isNaN(this.lastMouseY) && this.isMouseDown) {
                var scene = this.owner.scene;
                Laya.KeyBoardManager.hasKeyDown(87) && this.moveForward(-0.01 * elapsedTime); //W
                Laya.KeyBoardManager.hasKeyDown(83) && this.moveForward(0.01 * elapsedTime); //S
                Laya.KeyBoardManager.hasKeyDown(65) && this.moveRight(-0.01 * elapsedTime); //A
                Laya.KeyBoardManager.hasKeyDown(68) && this.moveRight(0.01 * elapsedTime); //D
                Laya.KeyBoardManager.hasKeyDown(81) && this.moveVertical(0.01 * elapsedTime); //Q
                Laya.KeyBoardManager.hasKeyDown(69) && this.moveVertical(-0.01 * elapsedTime); //E

                var offsetX = Laya.stage.mouseX - this.lastMouseX;
                var offsetY = Laya.stage.mouseY - this.lastMouseY;

                var yprElem = this.yawPitchRoll;
                yprElem.x -= offsetX * this.rotaionSpeed * elapsedTime;
                yprElem.y -= offsetY * this.rotaionSpeed * elapsedTime;
                this.updateRotation();
            }
            this.lastMouseX = Laya.stage.mouseX;
            this.lastMouseY = Laya.stage.mouseY;
        }
    }, {
        key: "mouseDown",
        value: function mouseDown(e) {
            //获得鼠标的旋转值
            this.camera.transform.localRotation.getYawPitchRoll(this.yawPitchRoll);
            //获得鼠标的xy值
            this.lastMouseX = Laya.stage.mouseX;
            this.lastMouseY = Laya.stage.mouseY;
            //设置bool值
            this.isMouseDown = true;
        }
    }, {
        key: "mouseUp",
        value: function mouseUp(e) {
            //设置bool值
            this.isMouseDown = false;
        }
        /**
         * 向前移动。
         */

    }, {
        key: "moveForward",
        value: function moveForward(distance) {
            this._tempVector3.x = 0;
            this._tempVector3.y = 0;
            this._tempVector3.z = distance;
            this.camera.transform.translate(this._tempVector3);
        }
        /**
         * 向右移动。
         */

    }, {
        key: "moveRight",
        value: function moveRight(distance) {
            this._tempVector3.y = 0;
            this._tempVector3.z = 0;
            this._tempVector3.x = distance;
            this.camera.transform.translate(this._tempVector3);
        }
        /**
         * 向上移动。
         */

    }, {
        key: "moveVertical",
        value: function moveVertical(distance) {
            this._tempVector3.x = this._tempVector3.z = 0;
            this._tempVector3.y = distance;
            this.camera.transform.translate(this._tempVector3, false);
        }
    }, {
        key: "updateRotation",
        value: function updateRotation() {
            if (Math.abs(this.yawPitchRoll.y) < 1.50) {
                Laya.Quaternion.createFromYawPitchRoll(this.yawPitchRoll.x, this.yawPitchRoll.y, this.yawPitchRoll.z, this.tempRotationZ);
                this.tempRotationZ.cloneTo(this.camera.transform.localRotation);
                this.camera.transform.localRotation = this.camera.transform.localRotation;
            }
        }
    }]);

    return CameraMoveScript;
}(Laya.Script3D);

exports.default = CameraMoveScript;

},{}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
        value: true
});

var _CameraMoveScript = require("./CameraMoveScript");

var _CameraMoveScript2 = _interopRequireDefault(_CameraMoveScript);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * 本示例采用非脚本的方式实现，而使用继承页面基类，实现页面逻辑。在IDE里面设置场景的Runtime属性即可和场景进行关联
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * 相比脚本方式，继承式页面类，可以直接使用页面定义的属性（通过IDE内var属性定义），比如this.tipLbll，this.scoreLbl，具有代码提示效果
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * 建议：如果是页面级的逻辑，需要频繁访问页面内多个元素，使用继承式写法，如果是独立小模块，功能单一，建议用脚本方式实现，比如子弹脚本。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */


var GameUI = function (_Laya$Scene) {
        _inherits(GameUI, _Laya$Scene);

        function GameUI() {
                _classCallCheck(this, GameUI);

                //加载场景文件
                var _this = _possibleConstructorReturn(this, (GameUI.__proto__ || Object.getPrototypeOf(GameUI)).call(this));

                _this.loadScene("test/TestScene.scene");

                //添加3D场景
                var scene = Laya.stage.addChild(new Laya.Scene3D());

                //添加照相机
                var camera = scene.addChild(new Laya.Camera(0, 0.1, 100));
                camera.transform.translate(new Laya.Vector3(0, 10, 10));
                camera.transform.rotate(new Laya.Vector3(-40, 0, 0), true, false);
                camera.clearColor = null;

                //添加方向光
                var directionLight = scene.addChild(new Laya.DirectionLight());
                directionLight.color = new Laya.Vector3(0.6, 0.6, 0.6);
                directionLight.transform.worldMatrix.setForward(new Laya.Vector3(1, -1, 0));

                //添加自定义模型
                var box = scene.addChild(new Laya.MeshSprite3D(Laya.PrimitiveMesh.createBox(100, 0.1, 100)));
                box.transform.rotate(new Laya.Vector3(0, 45, 0), false, false);
                var material = new Laya.BlinnPhongMaterial();
                Laya.Texture2D.load("res/layabox.png", Laya.Handler.create(null, function (tex) {
                        material.albedoTexture = tex;
                }));
                box.meshRenderer.material = material;

                // // 初始化场景,画面全屏
                // Laya3D.init(0, 0);
                // Laya.stage.scaleMode = Laya.Stage.SCALE_FULL;
                // // Laya.stage.screenMode = Laya.Stage.SCREEN_NONE;
                // Laya.Stat.show();
                // var scene = Laya.stage.addChild(new Laya.Scene3D());
                // scene.ambientColor = new Laya.Vector3(1, 1, 1);
                // var camera = scene.addChild(new Laya.Camera(0, 0.1, 100));
                // camera.transform.translate(new Laya.Vector3(0, 0.5, 1));
                // camera.transform.rotate(new Laya.Vector3(-15, 0, 0), true, false);
                camera.addComponent(_CameraMoveScript2.default);

                return _this;
        }

        return GameUI;
}(Laya.Scene);

exports.default = GameUI;

},{"./CameraMoveScript":3}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL0FQUC9nZWVrL0xheWFBaXJJREUvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcuanMiLCJzcmMvTWFpbi5qcyIsInNyYy9zY3JpcHQvQ2FtZXJhTW92ZVNjcmlwdC5qcyIsInNyYy9zY3JpcHQvR2FtZVVJLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7cWpCQ1ZBOzs7QUFDQTs7Ozs7Ozs7SUFFcUIsVTs7Ozs7OzsrQkFDSDtBQUNWO0FBQ0EsZ0JBQUksTUFBTSxLQUFLLFVBQUwsQ0FBZ0IsUUFBMUI7QUFDTixnQkFBSSxrQkFBSixFQUF1QixnQkFBdkI7QUFDRzs7Ozs7O0FBR0w7QUFDQTs7O2tCQVRxQixVO0FBVXJCLFdBQVcsU0FBWCxHQUF1QixLQUFLLEtBQUwsQ0FBVyxVQUFsQztBQUNBLFdBQVcsVUFBWCxHQUF3QixNQUF4QjtBQUNBLFdBQVcsVUFBWCxHQUF3QixzQkFBeEI7QUFDQSxXQUFXLFNBQVgsR0FBdUIsRUFBdkI7QUFDQSxXQUFXLEtBQVgsR0FBbUIsS0FBbkI7QUFDQSxXQUFXLElBQVgsR0FBa0IsSUFBbEI7QUFDQSxXQUFXLFlBQVgsR0FBMEIsSUFBMUI7QUFDQSxXQUFXLGlCQUFYLEdBQStCLElBQS9COztBQUVBLFdBQVcsSUFBWDs7Ozs7OztBQ3RCQTs7Ozs7Ozs7SUFDTSxJO0FBQ0wsaUJBQWM7QUFBQTs7QUFDYjtBQUNBLE1BQUksT0FBTyxRQUFQLENBQUosRUFBc0IsT0FBTyxJQUFQLENBQVkscUJBQVcsS0FBdkIsRUFBOEIscUJBQVcsTUFBekMsRUFBdEIsS0FDSyxLQUFLLElBQUwsQ0FBVSxxQkFBVyxLQUFyQixFQUE0QixxQkFBVyxNQUF2QyxFQUErQyxLQUFLLE9BQUwsQ0FBL0M7QUFDTCxPQUFLLFNBQUws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Y2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxuaW1wb3J0IEdhbWVVSSBmcm9tIFwiLi9zY3JpcHQvR2FtZVVJXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVDb25maWcge1xyXG4gICAgc3RhdGljIGluaXQoKSB7XHJcbiAgICAgICAgLy/ms6jlhoxTY3JpcHTmiJbogIVSdW50aW1l5byV55SoXHJcbiAgICAgICAgbGV0IHJlZyA9IExheWEuQ2xhc3NVdGlscy5yZWdDbGFzcztcclxuXHRcdHJlZyhcInNjcmlwdC9HYW1lVUkuanNcIixHYW1lVUkpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBHYW1lQ29uZmlnLndpZHRoID0gNjQwO1xyXG4vLyBHYW1lQ29uZmlnLmhlaWdodCA9IDExMzY7XHJcbkdhbWVDb25maWcuc2NhbGVNb2RlID0gTGF5YS5TdGFnZS5TQ0FMRV9GVUxMO1xyXG5HYW1lQ29uZmlnLnNjcmVlbk1vZGUgPSBcIm5vbmVcIjtcclxuR2FtZUNvbmZpZy5zdGFydFNjZW5lID0gXCJ0ZXN0L1Rlc3RTY2VuZS5zY2VuZVwiO1xyXG5HYW1lQ29uZmlnLnNjZW5lUm9vdCA9IFwiXCI7XHJcbkdhbWVDb25maWcuZGVidWcgPSBmYWxzZTtcclxuR2FtZUNvbmZpZy5zdGF0ID0gdHJ1ZTtcclxuR2FtZUNvbmZpZy5waHlzaWNzRGVidWcgPSB0cnVlO1xyXG5HYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uID0gdHJ1ZTtcclxuXHJcbkdhbWVDb25maWcuaW5pdCgpO1xyXG4iLCJpbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi9HYW1lQ29uZmlnXCI7XHJcbmNsYXNzIE1haW4ge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0Ly/moLnmja5JREXorr7nva7liJ3lp4vljJblvJXmk45cdFx0XHJcblx0XHRpZiAod2luZG93W1wiTGF5YTNEXCJdKSBMYXlhM0QuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcblx0XHRlbHNlIExheWEuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCwgTGF5YVtcIldlYkdMXCJdKTtcclxuXHRcdExheWFbXCJQaHlzaWNzXCJdICYmIExheWFbXCJQaHlzaWNzXCJdLmVuYWJsZSgpO1xyXG5cdFx0TGF5YVtcIkRlYnVnUGFuZWxcIl0gJiYgTGF5YVtcIkRlYnVnUGFuZWxcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhLnN0YWdlLnNjYWxlTW9kZSA9IEdhbWVDb25maWcuc2NhbGVNb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5zY3JlZW5Nb2RlID0gR2FtZUNvbmZpZy5zY3JlZW5Nb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5hbGlnblYgPSBHYW1lQ29uZmlnLmFsaWduVjtcclxuXHRcdExheWEuc3RhZ2UuYWxpZ25IID0gR2FtZUNvbmZpZy5hbGlnbkg7XHJcblx0XHQvL+WFvOWuueW+ruS/oeS4jeaUr+aMgeWKoOi9vXNjZW5l5ZCO57yA5Zy65pmvXHJcblx0XHRMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb247XHJcblxyXG5cdFx0Ly/miZPlvIDosIPor5XpnaLmnb/vvIjpgJrov4dJREXorr7nva7osIPor5XmqKHlvI/vvIzmiJbogIV1cmzlnLDlnYDlop7liqBkZWJ1Zz10cnVl5Y+C5pWw77yM5Z2H5Y+v5omT5byA6LCD6K+V6Z2i5p2/77yJXHJcblx0XHRpZiAoR2FtZUNvbmZpZy5kZWJ1ZyB8fCBMYXlhLlV0aWxzLmdldFF1ZXJ5U3RyaW5nKFwiZGVidWdcIikgPT0gXCJ0cnVlXCIpIExheWEuZW5hYmxlRGVidWdQYW5lbCgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcucGh5c2ljc0RlYnVnICYmIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdKSBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXS5lbmFibGUoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnN0YXQpIExheWEuU3RhdC5zaG93KCk7XHJcblx0XHRMYXlhLmFsZXJ0R2xvYmFsRXJyb3IgPSB0cnVlO1xyXG5cclxuXHRcdC8v5r+A5rS76LWE5rqQ54mI5pys5o6n5Yi277yMdmVyc2lvbi5qc29u55SxSURF5Y+R5biD5Yqf6IO96Ieq5Yqo55Sf5oiQ77yM5aaC5p6c5rKh5pyJ5Lmf5LiN5b2x5ZON5ZCO57ut5rWB56iLXHJcblx0XHRMYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pO1xyXG5cdH1cclxuXHJcblx0b25WZXJzaW9uTG9hZGVkKCkge1xyXG5cdFx0Ly/mv4DmtLvlpKflsI/lm77mmKDlsITvvIzliqDovb3lsI/lm77nmoTml7blgJnvvIzlpoLmnpzlj5HnjrDlsI/lm77lnKjlpKflm77lkIjpm4bph4zpnaLvvIzliJnkvJjlhYjliqDovb3lpKflm77lkIjpm4bvvIzogIzkuI3mmK/lsI/lm75cclxuXHRcdExheWEuQXRsYXNJbmZvTWFuYWdlci5lbmFibGUoXCJmaWxlY29uZmlnLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uQ29uZmlnTG9hZGVkKSk7XHJcblx0fVxyXG5cclxuXHRvbkNvbmZpZ0xvYWRlZCgpIHtcclxuXHRcdC8v5Yqg6L29SURF5oyH5a6a55qE5Zy65pmvXHJcblx0XHRHYW1lQ29uZmlnLnN0YXJ0U2NlbmUgJiYgTGF5YS5TY2VuZS5vcGVuKEdhbWVDb25maWcuc3RhcnRTY2VuZSk7XHJcblx0fVxyXG59XHJcbi8v5r+A5rS75ZCv5Yqo57G7XHJcbm5ldyBNYWluKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbWVyYU1vdmVTY3JpcHQgZXh0ZW5kcyBMYXlhLlNjcmlwdDNEe1xyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuX3RlbXBWZWN0b3IzID0gbmV3IExheWEuVmVjdG9yMygpO1xyXG4gICAgICAgIHRoaXMueWF3UGl0Y2hSb2xsID0gbmV3IExheWEuVmVjdG9yMygpO1xyXG4gICAgICAgIHRoaXMucmVzdWx0Um90YXRpb24gPSBuZXcgTGF5YS5RdWF0ZXJuaW9uKCk7XHJcbiAgICAgICAgdGhpcy50ZW1wUm90YXRpb25aID0gbmV3IExheWEuUXVhdGVybmlvbigpO1xyXG4gICAgICAgIHRoaXMudGVtcFJvdGF0aW9uWCA9IG5ldyBMYXlhLlF1YXRlcm5pb24oKTtcclxuICAgICAgICB0aGlzLnRlbXBSb3RhdGlvblkgPSBuZXcgTGF5YS5RdWF0ZXJuaW9uKCk7XHJcbiAgICAgICAgdGhpcy5yb3RhaW9uU3BlZWQgPSAwLjAwMDA2O1xyXG4gICAgfVxyXG5cdG9uQXdha2UoKXtcclxuXHRcdExheWEuc3RhZ2Uub24oTGF5YS5FdmVudC5SSUdIVF9NT1VTRV9ET1dOLCB0aGlzLCB0aGlzLm1vdXNlRG93bik7XHJcblx0XHRMYXlhLnN0YWdlLm9uKExheWEuRXZlbnQuUklHSFRfTU9VU0VfVVAsIHRoaXMsIHRoaXMubW91c2VVcCk7XHJcblx0XHR0aGlzLmNhbWVyYSA9IHRoaXMub3duZXI7XHJcblx0fVxyXG4gICAgX29uRGVzdHJveSgpIHtcclxuICAgICAgICAvL+WFs+mXreebkeWQrOWHveaVsFxyXG4gICAgICAgIExheWEuc3RhZ2Uub2ZmKExheWEuRXZlbnQuUklHSFRfTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5tb3VzZURvd24pO1xyXG4gICAgICAgIExheWEuc3RhZ2Uub2ZmKExheWEuRXZlbnQuUklHSFRfTU9VU0VfVVAsIHRoaXMsIHRoaXMubW91c2VVcCk7XHJcbiAgICB9XHJcbiAgICBvblVwZGF0ZShzdGF0ZSkge1xyXG5cdFx0dmFyIGVsYXBzZWRUaW1lID0gTGF5YS50aW1lci5kZWx0YTtcclxuXHRcdGlmICghaXNOYU4odGhpcy5sYXN0TW91c2VYKSAmJiAhaXNOYU4odGhpcy5sYXN0TW91c2VZKSAmJiB0aGlzLmlzTW91c2VEb3duKSB7XHJcblx0XHRcdHZhciBzY2VuZSA9IHRoaXMub3duZXIuc2NlbmU7XHJcblx0XHRcdExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oODcpICYmIHRoaXMubW92ZUZvcndhcmQoLTAuMDEgKiBlbGFwc2VkVGltZSk7Ly9XXHJcblx0XHRcdExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oODMpICYmIHRoaXMubW92ZUZvcndhcmQoMC4wMSAqIGVsYXBzZWRUaW1lKTsvL1NcclxuXHRcdFx0TGF5YS5LZXlCb2FyZE1hbmFnZXIuaGFzS2V5RG93big2NSkgJiYgdGhpcy5tb3ZlUmlnaHQoLTAuMDEgKiBlbGFwc2VkVGltZSk7Ly9BXHJcblx0XHRcdExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oNjgpICYmIHRoaXMubW92ZVJpZ2h0KDAuMDEgKiBlbGFwc2VkVGltZSk7Ly9EXHJcblx0XHRcdExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oODEpICYmIHRoaXMubW92ZVZlcnRpY2FsKDAuMDEgKiBlbGFwc2VkVGltZSk7Ly9RXHJcblx0XHRcdExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oNjkpICYmIHRoaXMubW92ZVZlcnRpY2FsKC0wLjAxICogZWxhcHNlZFRpbWUpOy8vRVxyXG5cdFx0XHRcdFxyXG5cdFx0XHR2YXIgb2Zmc2V0WCA9IExheWEuc3RhZ2UubW91c2VYIC0gdGhpcy5sYXN0TW91c2VYO1xyXG5cdFx0XHR2YXIgb2Zmc2V0WSA9IExheWEuc3RhZ2UubW91c2VZIC0gdGhpcy5sYXN0TW91c2VZO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHR2YXIgeXByRWxlbSA9IHRoaXMueWF3UGl0Y2hSb2xsO1xyXG5cdFx0XHR5cHJFbGVtLnggLT0gb2Zmc2V0WCAqIHRoaXMucm90YWlvblNwZWVkICogZWxhcHNlZFRpbWU7XHJcblx0XHRcdHlwckVsZW0ueSAtPSBvZmZzZXRZICogdGhpcy5yb3RhaW9uU3BlZWQgKiBlbGFwc2VkVGltZTtcclxuXHRcdFx0dGhpcy51cGRhdGVSb3RhdGlvbigpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5sYXN0TW91c2VYID0gTGF5YS5zdGFnZS5tb3VzZVg7XHJcblx0XHR0aGlzLmxhc3RNb3VzZVkgPSBMYXlhLnN0YWdlLm1vdXNlWTtcclxuXHRcdFxyXG4gICAgIFxyXG4gICAgfVxyXG4gICAgbW91c2VEb3duKGUpIHtcclxuICAgICAgICAvL+iOt+W+l+m8oOagh+eahOaXi+i9rOWAvFxyXG4gICAgICAgIHRoaXMuY2FtZXJhLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uLmdldFlhd1BpdGNoUm9sbCh0aGlzLnlhd1BpdGNoUm9sbCk7XHJcbiAgICAgICAgLy/ojrflvpfpvKDmoIfnmoR4eeWAvFxyXG4gICAgICAgIHRoaXMubGFzdE1vdXNlWCA9IExheWEuc3RhZ2UubW91c2VYO1xyXG4gICAgICAgIHRoaXMubGFzdE1vdXNlWSA9IExheWEuc3RhZ2UubW91c2VZO1xyXG4gICAgICAgIC8v6K6+572uYm9vbOWAvFxyXG4gICAgICAgIHRoaXMuaXNNb3VzZURvd24gPSB0cnVlO1xyXG4gICAgIFxyXG4gICAgfVxyXG4gICAgbW91c2VVcChlKSB7XHJcbiAgICAgICAgLy/orr7nva5ib29s5YC8XHJcbiAgICAgICAgdGhpcy5pc01vdXNlRG93biA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlkJHliY3np7vliqjjgIJcclxuICAgICAqL1xyXG4gICAgbW92ZUZvcndhcmQoZGlzdGFuY2UpIHtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy54ID0gMDtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy55ID0gMDtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy56ID0gZGlzdGFuY2U7XHJcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnRyYW5zbGF0ZSh0aGlzLl90ZW1wVmVjdG9yMyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWQkeWPs+enu+WKqOOAglxyXG4gICAgICovXHJcbiAgICBtb3ZlUmlnaHQoZGlzdGFuY2UpIHtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy55ID0gMDtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy56ID0gMDtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy54ID0gZGlzdGFuY2U7XHJcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnRyYW5zbGF0ZSh0aGlzLl90ZW1wVmVjdG9yMyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWQkeS4iuenu+WKqOOAglxyXG4gICAgICovXHJcbiAgICBtb3ZlVmVydGljYWwoZGlzdGFuY2UpIHtcclxuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy54ID0gdGhpcy5fdGVtcFZlY3RvcjMueiA9IDA7XHJcbiAgICAgICAgdGhpcy5fdGVtcFZlY3RvcjMueSA9IGRpc3RhbmNlO1xyXG4gICAgICAgIHRoaXMuY2FtZXJhLnRyYW5zZm9ybS50cmFuc2xhdGUodGhpcy5fdGVtcFZlY3RvcjMsIGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVSb3RhdGlvbigpIHtcclxuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy55YXdQaXRjaFJvbGwueSkgPCAxLjUwKSB7XHJcbiAgICAgICAgICAgIExheWEuUXVhdGVybmlvbi5jcmVhdGVGcm9tWWF3UGl0Y2hSb2xsKHRoaXMueWF3UGl0Y2hSb2xsLngsIHRoaXMueWF3UGl0Y2hSb2xsLnksIHRoaXMueWF3UGl0Y2hSb2xsLnosIHRoaXMudGVtcFJvdGF0aW9uWik7XHJcbiAgICAgICAgICAgIHRoaXMudGVtcFJvdGF0aW9uWi5jbG9uZVRvKHRoaXMuY2FtZXJhLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLmxvY2FsUm90YXRpb24gPSB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ubG9jYWxSb3RhdGlvbjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsIi8qKlxyXG4gKiDmnKznpLrkvovph4fnlKjpnZ7ohJrmnKznmoTmlrnlvI/lrp7njrDvvIzogIzkvb/nlKjnu6fmib/pobXpnaLln7rnsbvvvIzlrp7njrDpobXpnaLpgLvovpHjgILlnKhJREXph4zpnaLorr7nva7lnLrmma/nmoRSdW50aW1l5bGe5oCn5Y2z5Y+v5ZKM5Zy65pmv6L+b6KGM5YWz6IGUXHJcbiAqIOebuOavlOiEmuacrOaWueW8j++8jOe7p+aJv+W8j+mhtemdouexu++8jOWPr+S7peebtOaOpeS9v+eUqOmhtemdouWumuS5ieeahOWxnuaAp++8iOmAmui/h0lEReWGhXZhcuWxnuaAp+WumuS5ie+8ie+8jOavlOWmgnRoaXMudGlwTGJsbO+8jHRoaXMuc2NvcmVMYmzvvIzlhbfmnInku6PnoIHmj5DnpLrmlYjmnpxcclxuICog5bu66K6u77ya5aaC5p6c5piv6aG16Z2i57qn55qE6YC76L6R77yM6ZyA6KaB6aKR57mB6K6/6Zeu6aG16Z2i5YaF5aSa5Liq5YWD57Sg77yM5L2/55So57un5om/5byP5YaZ5rOV77yM5aaC5p6c5piv54us56uL5bCP5qih5Z2X77yM5Yqf6IO95Y2V5LiA77yM5bu66K6u55So6ISa5pys5pa55byP5a6e546w77yM5q+U5aaC5a2Q5by56ISa5pys44CCXHJcbiAqL1xyXG5pbXBvcnQgQ2FtZXJhTW92ZVNjcmlwdCBmcm9tIFwiLi9DYW1lcmFNb3ZlU2NyaXB0XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lVUkgZXh0ZW5kcyBMYXlhLlNjZW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgLy/liqDovb3lnLrmma/mlofku7ZcclxuICAgICAgICB0aGlzLmxvYWRTY2VuZShcInRlc3QvVGVzdFNjZW5lLnNjZW5lXCIpO1xyXG5cclxuICAgICAgICAvL+a3u+WKoDNE5Zy65pmvXHJcbiAgICAgICAgdmFyIHNjZW5lID0gTGF5YS5zdGFnZS5hZGRDaGlsZChuZXcgTGF5YS5TY2VuZTNEKCkpO1xyXG5cclxuICAgICAgICAvL+a3u+WKoOeFp+ebuOaculxyXG4gICAgICAgIHZhciBjYW1lcmEgPSAoc2NlbmUuYWRkQ2hpbGQobmV3IExheWEuQ2FtZXJhKDAsIDAuMSwgMTAwKSkpO1xyXG4gICAgICAgIGNhbWVyYS50cmFuc2Zvcm0udHJhbnNsYXRlKG5ldyBMYXlhLlZlY3RvcjMoMCwgMTAsIDEwKSk7XHJcbiAgICAgICAgY2FtZXJhLnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMygtNDAsIDAsIDApLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgY2FtZXJhLmNsZWFyQ29sb3IgPSBudWxsO1xyXG5cclxuICAgICAgICAvL+a3u+WKoOaWueWQkeWFiVxyXG4gICAgICAgIHZhciBkaXJlY3Rpb25MaWdodCA9IHNjZW5lLmFkZENoaWxkKG5ldyBMYXlhLkRpcmVjdGlvbkxpZ2h0KCkpO1xyXG4gICAgICAgIGRpcmVjdGlvbkxpZ2h0LmNvbG9yID0gbmV3IExheWEuVmVjdG9yMygwLjYsIDAuNiwgMC42KTtcclxuICAgICAgICBkaXJlY3Rpb25MaWdodC50cmFuc2Zvcm0ud29ybGRNYXRyaXguc2V0Rm9yd2FyZChuZXcgTGF5YS5WZWN0b3IzKDEsIC0xLCAwKSk7XHJcblxyXG4gICAgICAgIC8v5re75Yqg6Ieq5a6a5LmJ5qih5Z6LXHJcbiAgICAgICAgdmFyIGJveCA9IHNjZW5lLmFkZENoaWxkKG5ldyBMYXlhLk1lc2hTcHJpdGUzRChMYXlhLlByaW1pdGl2ZU1lc2guY3JlYXRlQm94KDEwMCwgMC4xLCAxMDApKSk7XHJcbiAgICAgICAgYm94LnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMygwLCA0NSwgMCksIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IExheWEuQmxpbm5QaG9uZ01hdGVyaWFsKCk7XHJcbiAgICAgICAgTGF5YS5UZXh0dXJlMkQubG9hZChcInJlcy9sYXlhYm94LnBuZ1wiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKG51bGwsIGZ1bmN0aW9uICh0ZXgpIHtcclxuICAgICAgICAgICAgbWF0ZXJpYWwuYWxiZWRvVGV4dHVyZSA9IHRleDtcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgYm94Lm1lc2hSZW5kZXJlci5tYXRlcmlhbCA9IG1hdGVyaWFsO1xyXG5cclxuICAgICAgICAvLyAvLyDliJ3lp4vljJblnLrmma8s55S76Z2i5YWo5bGPXHJcbiAgICAgICAgLy8gTGF5YTNELmluaXQoMCwgMCk7XHJcbiAgICAgICAgLy8gTGF5YS5zdGFnZS5zY2FsZU1vZGUgPSBMYXlhLlN0YWdlLlNDQUxFX0ZVTEw7XHJcbiAgICAgICAgLy8gLy8gTGF5YS5zdGFnZS5zY3JlZW5Nb2RlID0gTGF5YS5TdGFnZS5TQ1JFRU5fTk9ORTtcclxuICAgICAgICAvLyBMYXlhLlN0YXQuc2hvdygpO1xyXG4gICAgICAgIC8vIHZhciBzY2VuZSA9IExheWEuc3RhZ2UuYWRkQ2hpbGQobmV3IExheWEuU2NlbmUzRCgpKTtcclxuICAgICAgICAvLyBzY2VuZS5hbWJpZW50Q29sb3IgPSBuZXcgTGF5YS5WZWN0b3IzKDEsIDEsIDEpO1xyXG4gICAgICAgIC8vIHZhciBjYW1lcmEgPSBzY2VuZS5hZGRDaGlsZChuZXcgTGF5YS5DYW1lcmEoMCwgMC4xLCAxMDApKTtcclxuICAgICAgICAvLyBjYW1lcmEudHJhbnNmb3JtLnRyYW5zbGF0ZShuZXcgTGF5YS5WZWN0b3IzKDAsIDAuNSwgMSkpO1xyXG4gICAgICAgIC8vIGNhbWVyYS50cmFuc2Zvcm0ucm90YXRlKG5ldyBMYXlhLlZlY3RvcjMoLTE1LCAwLCAwKSwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgIGNhbWVyYS5hZGRDb21wb25lbnQoQ2FtZXJhTW92ZVNjcmlwdCk7XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuIl19
